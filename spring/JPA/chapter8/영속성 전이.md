# ì˜ì†ì„± ì „ì´ : CASCADE

íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡¤ ë§Œë“¤ ë•Œ  ì—°ê´€ëœ ì—”í‹°í‹°ë„ **í•¨ê»˜ ì˜ì† ìƒíƒœ**ë¡œ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ **ì˜ì†ì„± ì „ì´** ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```java
@Entity
public class Parent {
  @Id
  @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;

  private String name;

  @OneToMany(mappedBy = "parent")
  private List<Child> children = new ArrayList<Child>();
}

@Entity
public class Child {

  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;

  @ManyToOne
  private Parent parent;
}
```

ìœ„ì™€ ê°™ì€ ì—”í‹°í‹°ì—ì„œ ë¶€ëª¨ 1ëª…ê³¼ ìì‹ 2ëª…ì„ ì €ì¥í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì•¼ í•œë‹¤.

```java
// ë¶€ëª¨ ì €ì¥
Parent parent = new Parent();
em.persist(parent);

// 1ë²ˆ ìì‹ ì €ì¥
Child child1 = new Child();
child1.setParent(parent); // ìì‹ -> ë¶€ëª¨ ì—°ê´€ê´€ê³„ ì„¤ì •
parent.getChildren().add(child1); // ë¶€ëª¨ -> ìì‹
em.persist(child1);

Child child2 = new Child();
child2.setParent(parent); // ìì‹ -> ë¶€ëª¨ ì—°ê´€ê´€ê³„ ì„¤ì •
parent.getChildren().add(child2); // ë¶€ëª¨ -> ìì‹
em.persist(child2);
```

- ìœ„ ì½”ë“œëŠ” ë¶€ëª¨ ì—”í‹°í‹°ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ê³  ë‚˜ì„œ ìì‹ ì—”í‹°í‹°ë“¤ë„ **ê°ê° ì˜ì† ìƒíƒœ**ë¡œ ë§Œë“¤ì–´ ì£¼ì–´ì•¼ í•œë‹¤.
    
    â†’ ì˜ì†ì„± ì „ì´ë¥¼ ì‚¬ìš©í•˜ë©´ ë¶€ëª¨ë§Œ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ì–´ë„ ì—°ê´€ëœ ìì‹ê¹Œì§€ í•œ ë²ˆì— ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
    

ğŸ’¡ **JPAì—ì„œ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ ì—°ê´€ëœ ëª¨ë“  ì—”í‹°í‹°ëŠ” ì˜ì† ìƒíƒœì—¬ì•¼ í•œë‹¤.**

# ì˜ì†ì„± ì „ì´ : ì €ì¥

ì˜ì†ì„± ì „ì´ë¥¼ í™œì„±í™”í•˜ëŠ” CASCADE ì˜µì…˜ì„ ì ìš©í•˜ë©´ ì•„ë˜ ì½”ë“œì™€ ê°™ë‹¤.

```java
@Entity
public class Parent {
	// ...
	@OneToMany(mappedBy = "parent", cascade = CascadeType.PERSTIST)
	private List<Child> children = new ArrayList<Child>();
}
```

- **cascade = CascadeType.PERSIST** ì˜µì…˜ì„ ì„¤ì •í•˜ë©´ ë¶€ëª¨ì™€ ìì‹ ì—”í‹°í‹°ë¥¼ í•œ ë²ˆì— ì˜ì†í™” í•  ìˆ˜ ìˆë‹¤.

```java
Child child1 = new Child();
Child child2 = new Child();

Parent parent = new Parent();
child1.setParent(parent); // ìì‹ -> ë¶€ëª¨ ì—°ê´€ê´€ê³„ ì„¤ì •
child2.setParent(parent); // ìì‹ -> ë¶€ëª¨ ì—°ê´€ê´€ê³„ ì„¤ì •
parent.getChildren().add(child1); // ë¶€ëª¨ -> ìì‹
parent.getChildren().add(child2); // ë¶€ëª¨ -> ìì‹

// ë¶€ëª¨ ì €ì¥
em.persist(parent);
```

- ì˜ì†ì„± ì „ì´ëŠ” ì—”í‹°í‹°ë¥¼ ì˜ì†í™”í•  ë•Œ ì—°ê´€ëœ ì—”í‹°í‹°ë„ ê°™ì´ ì˜ì†í™”í•˜ëŠ” **í¸ë¦¬í•¨ë§Œ** ì œê³µí•œë‹¤.

# ì˜ì†ì„± ì „ì´ : ì‚­ì œ

ì €ì¥í•œ ë¶€ëª¨ì™€ ìì‹ ì—”í‹°í‹°ë¥¼ ëª¨ë‘ ì œê±°í•˜ë ¤ë©´ ê°ê°ì˜ ì—”í‹°í‹°ë¥¼ í•˜ë‚˜ì”© ì œê±°í•´ì•¼ í•œë‹¤.

```java
Parent findParent = em.find(Parent.class, 1L);
Child findChild1 = em.find(Child.class, 1L);
Child findChild2 = em.find(Child.class, 2L);

em.remove(findChild1);
em.remove(findChild2);
em.remove(findParent);
```

- CascadeType.REMOVEë¡œ ì„¤ì •í•˜ë©´ ë¶€ëª¨ ì—”í‹°í‹°ë§Œ ì‚­ì œí•˜ë©´ ì—°ê´€ëœ ìì‹ ì—”í‹°í‹°ë„ **í•¨ê»˜ ì‚­ì œ**í•  ìˆ˜ ìˆë‹¤.

```java
Parent findParent = em.find(Parent.class, 1L);
em.remove(findParent); // ìì‹ ì—”í‹°í‹°ê¹Œì§€ ì‚­ì œ
```

# CASCADEì˜ ì¢…ë¥˜

CascadeTypeì˜ ì˜µì…˜ì—ëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆë‹¤.